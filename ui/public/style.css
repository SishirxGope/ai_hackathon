:root {
    --bg-color: #f0f2f5;
    --card-bg: rgba(255, 255, 255, 0.9);
    --card-border: rgba(0, 0, 0, 0.08);
    --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);

    --accent-primary: #007AFF;
    --accent-secondary: #5856D6;
    --accent-warning: #FF9500;
    --accent-danger: #FF3B30;
    --accent-success: #34C759;

    --text-main: #1d1d1f;
    --text-secondary: #6e6e73;

    --font-heading: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
    --font-mono: 'SF Mono', 'Menlo', monospace;

    --radius: 12px;
    --gap: 16px;
    /* --section-gap */
    --internal-gap: 12px;
    --card-padding: 16px;
    --header-height: 64px;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    background-color: var(--bg-color);
    background-image:
        radial-gradient(at top left, rgba(0, 122, 255, 0.05), transparent 40%),
        radial-gradient(at bottom right, rgba(88, 86, 214, 0.05), transparent 40%);
    color: var(--text-main);
    font-family: var(--font-heading);
    /* UI content-sized, not viewport-sized */
    height: auto;
    min-height: 100vh;
    /* Optional: ensures bg covers full screen if content is small */
    overflow-x: hidden;
    overflow-y: auto;
    font-size: 14px;
    padding-bottom: 60px;
    /* Force scrollable space at bottom */
}

/* --- MAIN PAGE GRID --- */
.app-layout {
    display: grid;
    /* ROWS: Header, Main (auto), Charts (auto - flexible) */
    grid-template-rows: 64px auto auto;

    /* Layout Height Rules */
    height: auto;
    min-height: unset;
    align-content: start;

    padding: var(--gap);
    gap: var(--gap);
    max-width: 1920px;
    margin: 0 auto;
    /* Removed overflow: hidden to prevent clipping */
}

/* ROW 1: HEADER */
.app-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0.85), rgba(245, 248, 255, 0.85));
    backdrop-filter: blur(10px);
    border-radius: var(--radius);
    padding: 0 var(--card-padding);
    box-shadow: var(--card-shadow);
    border: 1px solid rgba(0, 0, 0, 0.05);
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.header-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-main);
}

.header-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.8rem;
    font-weight: 700;
    color: var(--accent-primary);
    background: rgba(0, 122, 255, 0.1);
    padding: 6px 12px;
    border-radius: 20px;
}

.status-dot {
    width: 8px;
    height: 8px;
    background: var(--accent-primary);
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(0, 122, 255, 0.4);
}

/* ROW 2: MAIN DASHBOARD GRID */
.row-main {
    display: grid;
    /* 3 COLUMNS: 3fr 6fr 3fr */
    grid-template-columns: 3fr 6fr 3fr;
    /* Row definition: auto sized, stretch items */
    grid-template-rows: auto;
    grid-auto-rows: minmax(min-content, max-content);
    /* ADDED per requirement */
    align-items: stretch;

    gap: var(--gap);
    min-height: 0;
}

/* PLACEMENT RULES */
.target-card {
    grid-column: 1;
    grid-row: 1;
    height: auto;
}

.diagnostics-card {
    grid-column: 1;
    grid-row: 2;
    overflow: hidden;
    height: auto;
    padding: var(--internal-gap) var(--card-padding);
}

/* Force left column to stack nicely at start */
/* Since direct grid children are placed explicitly in rows/cols, we don't need a wrapper 
   BUT we effectively have row 1 and row 2 for left column items. 
   If row-main only has 'auto', it might overlap unless we define rows.
   Actually, with grid-template-rows: auto, and items in row 1 and 2, it implies 2 rows.
   Let's keep row 2 as implicit or define it. 
   The user asked for `grid-template-rows: auto;` (singular).
   If we have items in grid-row: 2, the grid will create a 2nd row.
   That's fine.
*/

.info-card {
    grid-column: 2;
    grid-row: 1;
    align-self: end;
}

.main-rul-card {
    grid-column: 2;
    /* Visually it should be under info-card. */
    /* If info-card is row 1, this must be row 2. */
    grid-row: 2;

    /* SIZE LOCK */
    height: 320px;
    max-height: 320px;

    /* Flex Centering */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--internal-gap);

    padding: var(--internal-gap);
    overflow: hidden;
    /* Remove fake vertical fill */
    flex: unset;
}

.health-card {
    grid-column: 3;
    grid-row: 1 / span 2;
    /* Span both implicit rows */

    /* REMOVED FIXED HEIGHT to allow matching center column height */
    height: 100%;
    min-height: 300px;
    /* Minimum constraint only */

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* CARD STYLES */
/* CARD STYLES */
.card {
    background: linear-gradient(135deg, rgba(245, 248, 255, 0.9), rgba(235, 240, 255, 0.9));
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(120, 150, 255, 0.25);
    border-radius: 18px;
    padding: var(--card-padding);
    display: flex;
    flex-direction: column;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06), inset 0 1px 0 rgba(255, 255, 255, 0.6);
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
    /* Ensure sheen doesn't stick out if we have border-radius */
}

.card::after {
    content: "";
    position: absolute;
    inset: 1px;
    border-radius: inherit;
    pointer-events: none;
    background: linear-gradient(180deg,
            rgba(255, 255, 255, 0.6),
            rgba(255, 255, 255, 0.1));
    opacity: 0.4;
    z-index: 2;
}

.card:hover {
    transform: translateY(-3px);
    box-shadow:
        0 12px 30px rgba(0, 100, 255, 0.12),
        inset 0 1px 0 rgba(255, 255, 255, 0.7);
}

/* RUL Main Card Specific Tone-Down */
.main-rul-card {
    background: linear-gradient(135deg, rgba(225, 235, 255, 0.95), rgba(235, 240, 255, 0.95));
    min-height: 320px;
    /* Slightly taller */
}

.main-rul-card:hover .energy-core {
    filter: drop-shadow(0 0 24px rgba(0, 122, 255, 0.5));
}


.card-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    color: var(--text-secondary);
    font-weight: 700;
    letter-spacing: 0.5px;
    margin-bottom: var(--internal-gap);
    flex: 0 0 auto;
}

/* COMPONENT STYLES */
/* COMPONENT STYLES */
.cyber-select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background: linear-gradient(135deg, rgba(235, 242, 255, 0.95), rgba(245, 248, 255, 0.95));
    border: 1px solid rgba(120, 150, 255, 0.35);
    border-radius: 10px;
    padding: 10px 14px;
    padding-right: 32px;
    /* For arrow */
    font-weight: 600;
    color: #0f172a;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6), 0 4px 10px rgba(0, 0, 0, 0.05);
    outline: none;
    cursor: pointer;
    transition: all 0.2s ease;

    /* Custom Arrow */
    background-image: url("data:image/svg+xml;utf8,<svg fill='none' stroke='%230f172a' stroke-width='2' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'><path d='M6 9l6 6 6-6'/></svg>");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px;
}

.cyber-select:hover {
    border-color: rgba(0, 120, 255, 0.6);
}

.cyber-select:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
}

.cyber-select option {
    background: rgba(235, 242, 255, 0.98);
    color: #0f172a;
    font-weight: 500;
}

/* Diagnostics */
.diag-list {
    display: flex;
    flex-direction: column;
    gap: var(--internal-gap);
    overflow-y: auto;
}

.diag-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9rem;
    padding-bottom: 8px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.03);
}

.badge-blue {
    background: rgba(0, 122, 255, 0.1);
    color: var(--accent-primary);
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 700;
}

.val {
    font-family: var(--font-mono);
    font-weight: 600;
}

/* Info Stats */
.info-stats {
    display: flex;
    justify-content: space-around;
    background: rgba(0, 0, 0, 0.02);
    border-radius: 8px;
    padding: 12px;
}

.info-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
}

.info-stat span {
    font-size: 0.7rem;
    color: var(--text-secondary);
    font-weight: 600;
}

.info-stat strong {
    font-size: 1.1rem;
    color: var(--text-main);
}

/* Main RUL Rocket */
/* Rocket Gauge Container */
/* Rocket Gauge Container */
/* Energy Ring Core */
/* Energy Ring Core */
.energy-core {
    position: relative;
    width: 240px;
    height: 240px;
    margin-bottom: 8px;
    filter: drop-shadow(0 0 12px rgba(0, 122, 255, 0.25));
    animation: corePulse 3.5s ease-in-out infinite;
    transition: filter 0.3s ease;
}

.energy-ring {
    width: 100%;
    height: 100%;
}

/* Center text */
.energy-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}

/* Rotating sci-fi outer ring */
.energy-outer-rotate {
    transform-origin: 50% 50%;
    animation: spin 20s linear infinite;
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

@keyframes corePulse {
    0% {
        filter: drop-shadow(0 0 10px rgba(0, 122, 255, 0.25));
    }

    50% {
        filter: drop-shadow(0 0 20px rgba(0, 122, 255, 0.45));
    }

    100% {
        filter: drop-shadow(0 0 10px rgba(0, 122, 255, 0.25));
    }
}

/* Subtle liquid motion */
@keyframes liquidWave {
    0% {
        filter: hue-rotate(0deg);
    }

    100% {
        filter: hue-rotate(12deg);
    }
}

.rul-value {
    font-size: 3.8rem;
    font-weight: 800;
    line-height: 1;
    color: #0f172a;
    /* Darker for contrast */
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    letter-spacing: -2px;
    margin-bottom: 0;
}

.rul-subtitle {
    font-size: 0.8rem;
    color: var(--text-secondary);
    font-weight: 600;
    text-transform: uppercase;
    margin-bottom: 8px;
}

.stat-pills {
    display: flex;
    gap: 12px;
    margin-top: 0;
}

.stat-pill {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(6px);
    border: 1px solid rgba(0, 0, 0, 0.05);
    padding: 6px 12px;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 70px;
    transition: all 0.2s ease;
}

.stat-pill:hover {
    background: rgba(255, 255, 255, 0.85);
}

.pill-label {
    font-size: 0.6rem;
    color: var(--text-secondary);
    font-weight: 700;
    text-transform: uppercase;
}

.pill-val {
    font-size: 0.9rem;
    font-weight: 700;
    color: var(--text-main);
}

/* Health Gauge */
.gauge-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    /* Gap between gauge and pill */
    min-height: 0;
}

.gauge-container {
    width: 220px;
    height: 110px;
    /* Half of 220px */
    position: relative;
    overflow: hidden;
    flex: 0 0 auto;
}

.gauge-body {
    width: 220px;
    height: 220px;
    border-radius: 50%;
    background: #f0f0f0;
    position: relative;
    box-shadow: inset 0 4px 10px rgba(0, 0, 0, 0.05);
}

.gauge-ticks {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    /* Subtle ticks */
    background: repeating-conic-gradient(from 270deg, rgba(0, 0, 0, 0.1) 0deg 2deg, transparent 2deg 10deg);
}

.gauge-fill {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    /* Default color (nominal) */
    background: linear-gradient(90deg, #34C759, #6DFF9A);
    filter: drop-shadow(0 0 6px rgba(52, 199, 89, 0.5));
    transition: width 0.3s ease, background 0.3s ease;
}

.gauge-fill.nominal {
    background: linear-gradient(90deg, #34C759, #6DFF9A);
    filter: drop-shadow(0 0 6px rgba(52, 199, 89, 0.5));
}

.gauge-fill.warning {
    background: linear-gradient(90deg, #FF9500, #FFD60A);
    filter: drop-shadow(0 0 6px rgba(255, 149, 0, 0.5));
}

.gauge-fill.critical {
    background: linear-gradient(90deg, #FF3B30, #FF453A);
    filter: drop-shadow(0 0 6px rgba(255, 59, 48, 0.5));
}

.gauge-mask {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    /* This mask hides the part of the fill we don't want to see */
    /* Conic gradient reveal logic handled by JS --gauge-percent */
    background: conic-gradient(from 270deg, transparent 0% var(--gauge-percent, 0%), #f0f0f0 var(--gauge-percent, 0%) 100%);
    transition: background 0.5s ease;
}

.gauge-body::after {
    content: '';
    position: absolute;
    background: #fff;
    /* Match card bg if possible, or force white */
    /* Stroke calculation: 220px width - (14px * 2) = 192px hole */
    /* Inset = 14px */
    inset: 14px;
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.gauge-center-text {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 14px;
    /* Align to bottom stroke essentially */
    display: flex;
    align-items: flex-end;
    /* Align text to bottom baseline of semi-circle */
    justify-content: center;
    z-index: 20;
    /* Actually user wants "Absolutely centered inside the semi-circle" */
    /* For a semi-circle, visually centered is usually slightly up from bottom. */
    /* But standard "centered within semi-circle area" means bottom center for gauge value. */
    /* Let's position it absolute bottom: 0, text-align center. */
    height: 100%;
    /* Cover full semi-circle area */
}

.health-val {
    position: absolute;
    bottom: 5px;
    /* Sit nicely above the cut-off */
    font-size: 36px;
    font-weight: 700;
    color: var(--text-main);
    line-height: 1;
}

.health-pill {
    padding: 6px 14px;
    border-radius: 999px;
    font-weight: 600;
    font-size: 13px;
    text-transform: uppercase;
    transition: all 0.3s ease;
}

/* Status colors defined previously: .status-nominal, etc. ensure they work with background/color */


.status-nominal {
    background: rgba(52, 199, 89, 0.15);
    color: var(--accent-success);
}

.status-warning {
    background: rgba(255, 149, 0, 0.15);
    color: var(--accent-warning);
}

.status-critical {
    background: rgba(255, 59, 48, 0.15);
    color: var(--accent-danger);
}


/* ROW 3: CHARTS */
.row-charts {
    display: grid;
    /* 3 EQUAL COLUMNS */
    grid-template-columns: 1fr 1fr 1fr;
    gap: var(--gap);
    /* Flexible Height */
    height: auto;
    /* Removed fixed 260px and overflow hidden */
}

.chart-card {
    display: flex;
    flex-direction: column;
    /* Flexible height with minimum */
    height: auto;
    min-height: 280px;
    transition: all 0.2s ease;
}

/* Removed hover glow for consistency */


.canvas-box {
    flex: 1;
    position: relative;
    width: 100%;
    height: 0;
    /* Important hack to force canvas scaling */
    min-height: 0;
}

canvas {
    width: 100% !important;
    height: 100% !important;
}

/* RESPONSIVE FALLBACK */
@media (max-width: 1200px) {
    .app-layout {
        display: block;
        height: auto;
    }

    .row-main,
    .row-charts {
        display: flex;
        flex-direction: column;
        grid-template-rows: unset;
        height: auto;
    }

    .main-rul-card,
    .health-card {
        height: auto;
        min-height: 300px;
    }

    .chart-card {
        height: 300px;
    }
}